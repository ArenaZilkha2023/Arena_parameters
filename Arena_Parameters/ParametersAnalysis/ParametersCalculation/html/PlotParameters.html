
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>PlotParameters</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-07-05"><meta name="DC.source" content="PlotParameters.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#3">--Variables--</a></li><li><a href="#5">-------------Read each sheet and create a figure for each parameter--------------</a></li><li><a href="#7">Find limits of each parameter</a></li><li><a href="#8">----Running parameter</a></li><li><a href="#9">----Running parameter Active------------------------</a></li><li><a href="#10">----Walking parameter</a></li><li><a href="#11">%% ----Walking parameter of active time</a></li><li><a href="#12">----Static parameter of exp time-------------</a></li><li><a href="#13">----Static parameter of active time-------------</a></li><li><a href="#14">%% ----movement parameter of active time---------</a></li><li><a href="#15">%% ----movement parameter of active time---------</a></li><li><a href="#16">%%  %% ----Sleeping parameter</a></li><li><a href="#17">%%  %% ----Eating parameter</a></li><li><a href="#18">%%  %% ----Eating parameter in Active Time</a></li><li><a href="#19">%%  %% ----Drinking parameter</a></li><li><a href="#20">%%  %% ----Drinking parameter ACTIVE TIME</a></li><li><a href="#21">%%  %% ----Hiding parameter -------------------------</a></li><li><a href="#22">%%  %% ----Arena parameter</a></li><li><a href="#23">%%  %% ----alone parameter</a></li><li><a href="#24">%%  %% ----alone parameter in active time</a></li><li><a href="#25">%%  %% ----chasing parameter</a></li><li><a href="#26">%%  %% ---- being chasing parameter</a></li><li><a href="#27">----------------Chasing + being chasing</a></li><li><a href="#28">%% ----------------Dist pairs</a></li><li><a href="#29">%% %% ----------------Velocity</a></li><li><a href="#30">%% %% ----------------together all----</a></li><li><a href="#31">-----------------Inside active zone----------------</a></li><li><a href="#32">-----------------Outside active zone----------------</a></li><li><a href="#33">------------Insert Elo rating graphs per each experiment------------------</a></li><li><a href="#34">----------------Load the data-----------------------</a></li><li><a href="#35">-----------------Plot interaction matrix-first mouse dominant------------</a></li><li><a href="#39">To save into the excel files</a></li><li><a href="#40">Activate excel file</a></li><li><a href="#41">Activate excel file</a></li><li><a href="#42">Activate excel file</a></li><li><a href="#43">Activate excel file</a></li><li><a href="#44">Activate excel file</a></li><li><a href="#45">Activate excel file</a></li><li><a href="#46">Activate excel file</a></li><li><a href="#47">Activate excel file</a></li><li><a href="#48">Activate excel file</a></li><li><a href="#49">Activate excel file</a></li><li><a href="#50">Activate excel file</a></li><li><a href="#51">Activate excel file</a></li><li><a href="#52">Activate excel file</a></li><li><a href="#53">Activate excel file</a></li><li><a href="#54">Activate excel file</a></li><li><a href="#55">Activate excel file</a></li><li><a href="#56">%% Activate excel file</a></li><li><a href="#57">%% %% Activate excel file</a></li><li><a href="#59">%% %% Activate excel file</a></li><li><a href="#60">%% %% Activate excel file</a></li><li><a href="#61">%% %% %% Activate excel file</a></li><li><a href="#62">%% %% Activate excel file</a></li><li><a href="#63">%% %% Activate excel file</a></li><li><a href="#64">%% %% Activate excel file</a></li><li><a href="#65">%% %% Activate excel file</a></li><li><a href="#66">%% %% Activate excel file</a></li><li><a href="#67">%% %% Activate excel file</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [ output_args ] =PlotParameters(Filename,SelectedExperiments,FilenameChasingData1)
</pre><pre class="codeinput"><span class="keyword">global</span> h
</pre><h2>--Variables--<a name="3"></a></h2><pre class="codeinput">NumberMice=str2num(get(h.editMouse,<span class="string">'string'</span>));<span class="comment">%number of mice to plot</span>
Days=str2num(get(h.editDays,<span class="string">'string'</span>))<span class="comment">%number of days to plot</span>



cc=jet(NumberMice);<span class="comment">%for getting colors</span>
</pre><pre class="codeoutput">
Days =

     6

</pre><pre class="codeinput"><span class="comment">%Plot parameters-Add to excel file</span>
<span class="comment">%--for saving into excel file create temp file for each exp---------------</span>
tempfigfile=[tempname <span class="string">'.png'</span>];
temp=figure;
set (temp, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile1=[tempname <span class="string">'.png'</span>];
temp1=figure;
set (temp1, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile2=[tempname <span class="string">'.png'</span>];
temp2=figure;
set (temp2, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile3=[tempname <span class="string">'.png'</span>];
temp3=figure;
set (temp3, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);


tempfigfile4=[tempname <span class="string">'.png'</span>];
temp4=figure;
set (temp4, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);


tempfigfile5=[tempname <span class="string">'.png'</span>];
temp5=figure;
set (temp5, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile6=[tempname <span class="string">'.png'</span>];
temp6=figure;
set (temp6, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile7=[tempname <span class="string">'.png'</span>];
temp7=figure;
set (temp7, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);


tempfigfile8=[tempname <span class="string">'.png'</span>];
temp8=figure;
set (temp8, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile9=[tempname <span class="string">'.png'</span>];
temp9=figure;
set (temp9, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);


tempfigfile10=[tempname <span class="string">'.png'</span>];
temp10=figure;
set (temp10, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile11=[tempname <span class="string">'.png'</span>];
temp11=figure;
set (temp11, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile12=[tempname <span class="string">'.png'</span>];
temp12=figure;
set (temp12, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile13=[tempname <span class="string">'.png'</span>];
temp13=figure;
set (temp13, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile14=[tempname <span class="string">'.png'</span>];
temp14=figure;
set (temp14, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile15=[tempname <span class="string">'.png'</span>];
temp15=figure;
set (temp15, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile16=[tempname <span class="string">'.png'</span>];
temp16=figure;
set (temp16, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile17=[tempname <span class="string">'.png'</span>];
temp17=figure;
set (temp17, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);
<span class="comment">%</span>
tempfigfile18=[tempname <span class="string">'.png'</span>];
temp18=figure;
set (temp18, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile19=[tempname <span class="string">'.png'</span>];
temp19=figure;
set (temp19, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile20=[tempname <span class="string">'.png'</span>];
temp20=figure;
set (temp20, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile21=[tempname <span class="string">'.png'</span>];
temp21=figure;
set (temp21, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile22=[tempname <span class="string">'.png'</span>];
temp22=figure;
set (temp22, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);

tempfigfile23=[tempname <span class="string">'.png'</span>];
temp23=figure;
set (temp23, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);


tempfigfile24=[tempname <span class="string">'.png'</span>];
temp24=figure;
set (temp24, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);



tempfigfile25=[tempname <span class="string">'.png'</span>];
temp25=figure;
set (temp25, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);



tempfigfile26=[tempname <span class="string">'.png'</span>];
temp26=figure;
set (temp26, <span class="string">'Units'</span>, <span class="string">'normalized'</span>, <span class="string">'Position'</span>, [0,0,1,1]);
</pre><img vspace="5" hspace="5" src="PlotParameters_01.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_02.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_03.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_04.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_05.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_06.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_07.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_08.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_09.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_10.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_11.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_12.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_13.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_14.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_15.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_16.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_17.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_18.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_19.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_20.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_21.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_22.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_23.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_24.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_25.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_26.png" alt=""> <img vspace="5" hspace="5" src="PlotParameters_27.png" alt=""> <h2>-------------Read each sheet and create a figure for each parameter--------------<a name="5"></a></h2><pre class="codeinput">clear <span class="string">raw</span>;

hbar = waitbar(0,<span class="string">'Please wait...'</span>);
<span class="keyword">for</span> i=1:length(SelectedExperiments)
</pre><pre class="codeinput">    sheet=char(SelectedExperiments(i))
 [num,txt,raw]=xlsread(Filename,sheet);
</pre><h2>Find limits of each parameter<a name="7"></a></h2><h2>----Running parameter<a name="8"></a></h2><pre class="codeinput"> IndexRunning=find(strcmp(<span class="string">'RunningTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp)
 <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
 <span class="keyword">end</span>
hfig=bar(cell2mat(raw(IndexRunning:IndexRunning+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;

xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexRunning:IndexRunning+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'RunningTime(% of time)'</span>)
</pre><h2>----Running parameter Active------------------------<a name="9"></a></h2><pre class="codeinput"> IndexRunningA=find(strcmp(<span class="string">'RunningTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp18)
 <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
 <span class="keyword">end</span>
hfig=bar(cell2mat(raw(IndexRunningA:IndexRunningA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;

xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexRunningA:IndexRunningA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'RunningTime(% of Active time)'</span>)
</pre><h2>----Walking parameter<a name="10"></a></h2><pre class="codeinput"> IndexWalking=find(strcmp(<span class="string">'WalkingTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp1)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>


hfig=bar(cell2mat(raw(IndexWalking:IndexWalking+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)));
l=strcat(<span class="string">''''</span>,raw(IndexWalking:IndexWalking+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'WalkingTime(% of time)'</span>)
</pre><h2>%% ----Walking parameter of active time<a name="11"></a></h2><pre class="codeinput"> IndexWalkingA=find(strcmp(<span class="string">'WalkingTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp19)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>


hfig=bar(cell2mat(raw(IndexWalkingA:IndexWalkingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)));
l=strcat(<span class="string">''''</span>,raw(IndexWalkingA:IndexWalkingA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'WalkingTime(% of active time)'</span>)
</pre><h2>----Static parameter of exp time-------------<a name="12"></a></h2><pre class="codeinput"> IndexStatic=find(strcmp(<span class="string">'StaticTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp2)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexStatic:IndexStatic+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexStatic:IndexStatic+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'StaticTime(% of time))'</span>)
</pre><h2>----Static parameter of active time-------------<a name="13"></a></h2><pre class="codeinput"> IndexStaticA=find(strcmp(<span class="string">'StaticTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp20)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexStaticA:IndexStaticA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexStaticA:IndexStaticA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'StaticTime(% of active time)'</span>)
</pre><h2>%% ----movement parameter of active time---------<a name="14"></a></h2><pre class="codeinput"> IndexMovementA=find(strcmp(<span class="string">'movementTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp21)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexMovementA:IndexMovementA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexMovementA:IndexMovementA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'movementTime(% of active time)'</span>)
</pre><h2>%% ----movement parameter of active time---------<a name="15"></a></h2><pre class="codeinput"> IndexMovement=find(strcmp(<span class="string">'movementTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp3)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexMovement:IndexMovement+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexMovement:IndexMovement+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'movementTime(% of time)'</span>)
</pre><h2>%%  %% ----Sleeping parameter<a name="16"></a></h2><pre class="codeinput"> IndexSleeping=find(strcmp(<span class="string">'sleepingSumTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp4)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>


hfig=bar(cell2mat(raw(IndexSleeping:IndexSleeping+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexSleeping:IndexSleeping+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'sleepingSumTime(% of time)'</span>)
</pre><h2>%%  %% ----Eating parameter<a name="17"></a></h2><pre class="codeinput"> IndexEating=find(strcmp(<span class="string">'eatingSumTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp5)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexEating:IndexEating+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexEating:IndexEating+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'eatingSumTime(% of time)'</span>)
</pre><h2>%%  %% ----Eating parameter in Active Time<a name="18"></a></h2><pre class="codeinput"> IndexEatingA=find(strcmp(<span class="string">'eatingSumTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp22)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexEatingA:IndexEatingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexEatingA:IndexEatingA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'eatingSumTime(% of time)'</span>)
</pre><h2>%%  %% ----Drinking parameter<a name="19"></a></h2><pre class="codeinput"> IndexDrinking=find(strcmp(<span class="string">'drinkingSumTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp6)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexDrinking:IndexDrinking+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexDrinking:IndexDrinking+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'drinkingSumTime(% of time)'</span>)
</pre><h2>%%  %% ----Drinking parameter ACTIVE TIME<a name="20"></a></h2><pre class="codeinput"> IndexDrinkingA=find(strcmp(<span class="string">'drinkingSumTimeActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp23)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexDrinkingA:IndexDrinkingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexDrinkingA:IndexDrinkingA+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'drinkingSumTime(% of Active time)'</span>)
</pre><h2>%%  %% ----Hiding parameter -------------------------<a name="21"></a></h2><pre class="codeinput"> IndexHiding=find(strcmp(<span class="string">'hidingSumTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp7)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>


hfig=bar(cell2mat(raw(IndexHiding:IndexHiding+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexHiding:IndexHiding+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'hidingSumTime(% of time)'</span>)
</pre><h2>%%  %% ----Arena parameter<a name="22"></a></h2><pre class="codeinput"> IndexArena=find(strcmp(<span class="string">'ArenaSumTime(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp8)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexArena:IndexArena+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexArena:IndexArena+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'ArenaSumTime(% of time)'</span>)
</pre><h2>%%  %% ----alone parameter<a name="23"></a></h2><pre class="codeinput"> IndexAlone=find(strcmp(<span class="string">'CenterTimeAlone(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp9)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexAlone:IndexAlone+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexAlone:IndexAlone+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'CenterTimeAlone(% of time)'</span>)
</pre><h2>%%  %% ----alone parameter in active time<a name="24"></a></h2><pre class="codeinput"> IndexAlone=find(strcmp(<span class="string">'CenterTimeAloneActive(% of Active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp24)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexAlone:IndexAlone+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexAlone:IndexAlone+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'CenterTimeAloneActive(% of Active time)'</span>)
</pre><h2>%%  %% ----chasing parameter<a name="25"></a></h2><pre class="codeinput"> IndexChasing=find(strcmp(<span class="string">'chasing all (N events)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp10)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexChasing:IndexChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexChasing:IndexChasing+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'chasing all (N events)'</span>)
</pre><h2>%%  %% ---- being chasing parameter<a name="26"></a></h2><pre class="codeinput"> IndexBeingChasing=find(strcmp(<span class="string">'being chased all(N events)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp11)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw(IndexBeingChasing:IndexBeingChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw(IndexBeingChasing:IndexBeingChasing+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'being chased all(N events)'</span>)
</pre><h2>----------------Chasing + being chasing<a name="27"></a></h2><pre class="codeinput"> IndexBeingPlusChasing=find(strcmp(<span class="string">'Chasing plus being chasing all(N events)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp12)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexBeingPlusChasing: IndexBeingPlusChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexBeingPlusChasing: IndexBeingPlusChasing+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'Chasing plus being chasing all(N events)'</span>)
</pre><h2>%% ----------------Dist pairs<a name="28"></a></h2><pre class="codeinput"> IndexDistance=find(strcmp(<span class="string">'DistPairs all(average (cm))'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp13)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexDistance: IndexDistance+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexDistance: IndexDistance+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'DistPairs all(average (cm))'</span>)
</pre><h2>%% %% ----------------Velocity<a name="29"></a></h2><pre class="codeinput"> IndexVelocity=find(strcmp(<span class="string">'Average velocity (average (cm/sec))'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp14)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexVelocity: IndexVelocity+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexVelocity: IndexVelocity+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'Average velocity (average (cm/sec))'</span>)
</pre><h2>%% %% ----------------together all----<a name="30"></a></h2><pre class="codeinput"> IndexTogether=find(strcmp(<span class="string">'togetherAll(% of time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp15)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexTogether: IndexTogether+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'togetherAll(% of time)'</span>)
</pre><h2>-----------------Inside active zone----------------<a name="31"></a></h2><pre class="codeinput"> IndexTogether=find(strcmp(<span class="string">'InsideZoneTime(% of active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp25)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexTogether: IndexTogether+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'InsideZoneTime(% of active time)'</span>)
</pre><h2>-----------------Outside active zone----------------<a name="32"></a></h2><pre class="codeinput"> IndexTogether=find(strcmp(<span class="string">'OutsideZoneTime(% of active time)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp26)

  <span class="keyword">if</span> length(SelectedExperiments)==1
     subplot(1,1,1)
 <span class="keyword">else</span>
subplot(round(length(SelectedExperiments)/3),3,i)
  <span class="keyword">end</span>

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat(<span class="string">''''</span>,raw( IndexTogether: IndexTogether+NumberMice-1,2),<span class="string">''''</span>);
legend(hfig,l,<span class="string">'Location'</span>,<span class="string">'northwestoutside'</span>)

title(<span class="string">'OutsideZoneTime(% of active time)'</span>)
</pre><h2>------------Insert Elo rating graphs per each experiment------------------<a name="33"></a></h2><h2>----------------Load the data-----------------------<a name="34"></a></h2><pre class="codeinput">set(0,<span class="string">'CurrentFigure'</span>,temp16)
FilenameChasingData=strcat(FilenameChasingData1,SelectedExperiments(i),<span class="string">'\'</span>,<span class="string">'Data'</span>,<span class="string">'\'</span>,<span class="string">'ChasingResults'</span>,<span class="string">'\'</span>,strcat(SelectedExperiments(i),<span class="string">'_ChasingResults.xlsx'</span>));

sheet=<span class="string">'Elo-rating All Events'</span>;
[num txt EloMatrixOrder]=xlsread(char(FilenameChasingData),sheet);

sheet1=<span class="string">'Elo-rating per day order'</span>;
[num txt EloeDayTotalOrder]=xlsread(char(FilenameChasingData),sheet1);

sheet2=<span class="string">'Ranking'</span>;
[num txt Ranking]=xlsread(char(FilenameChasingData),sheet2);

 IndEAD=find(strcmp(<span class="string">'Mean Elorating per day'</span>,raw(:,1))==1);

subplot(length(SelectedExperiments),3,i+1) <span class="comment">%plot Elo per day</span>
<span class="keyword">for</span> j=2:length(Ranking(:,1))+1
    T=char(EloeDayTotalOrder(1,j));
plot(cell2mat(EloeDayTotalOrder(2:end,1)),cell2mat(EloeDayTotalOrder(2:end,j)),<span class="string">'-*'</span>,<span class="string">'MarkerSize'</span>,12,<span class="string">'DisplayName'</span>,T,<span class="string">'Color'</span>,cc(j-1,:));
<span class="comment">% legend('-DynamicLegend','Location','northeastoutside');</span>
hold <span class="string">all</span>;
title(<span class="string">'Last Event of Elo-rating per  day'</span>,<span class="string">'FontSize'</span>,12)
xlabel(<span class="string">'Days'</span>,<span class="string">'FontSize'</span>,12)
ylabel(<span class="string">'Elo-rating'</span>,<span class="string">'FontSize'</span>,12)

<span class="keyword">end</span>


hold <span class="string">on</span>;
raw1=[];
<span class="comment">%add initial point 0 is 1000</span>
raw1(1:length(Ranking(:,1)),1)=1000;
raw1(:,2:2+Days-1)=cell2mat(raw(IndEAD:IndEAD+length(Ranking(:,1))-1,3:3+Days-1));

subplot(length(SelectedExperiments),3,i+2) <span class="comment">%plot Elo per day by assuming the average</span>
<span class="keyword">for</span> j=2:length(Ranking(:,1))+1
    T=char(EloeDayTotalOrder(1,j));



plot(cell2mat(EloeDayTotalOrder(2:end,1)),raw1(j-1,1:Days+1),<span class="string">'-*'</span>,<span class="string">'MarkerSize'</span>,12,<span class="string">'DisplayName'</span>,T,<span class="string">'Color'</span>,cc(j-1,:));
<span class="comment">% legend('-DynamicLegend','Location','northeastoutside');</span>
hold <span class="string">all</span>;
title(<span class="string">'Average Elo-rating per day'</span>,<span class="string">'FontSize'</span>,12)
xlabel(<span class="string">'Days'</span>,<span class="string">'FontSize'</span>,12)
ylabel(<span class="string">'Elo-rating'</span>,<span class="string">'FontSize'</span>,12)

<span class="keyword">end</span>


hold <span class="string">on</span>;



subplot(length(SelectedExperiments),3,i)<span class="comment">%plot per event</span>
<span class="comment">%find Events column</span>
IndexEvents=find(strcmp(EloMatrixOrder(1,:),<span class="string">'Events'</span>)==1);
IndexDay=find(strcmp(EloMatrixOrder(1,:),<span class="string">'Day'</span>)==1);
IndexFirstDay=find(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexDay))==1);
<span class="comment">%find where the first day finished</span>

<span class="keyword">for</span> j=4:length(Ranking(:,1))+3

    T=char(EloMatrixOrder(1,j));
plot(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexEvents)),cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,j)),<span class="string">'DisplayName'</span>,T,<span class="string">'Color'</span>,cc(j-3,:));
legend(<span class="string">'-DynamicLegend'</span>,<span class="string">'Location'</span>,<span class="string">'northeastoutside'</span>);
hold <span class="string">all</span>;
title(strcat(char(SelectedExperiments(i)),<span class="string">'Elo-rating per event'</span>),<span class="string">'FontSize'</span>,12)
xlabel(<span class="string">'Events'</span>,<span class="string">'FontSize'</span>,12)
ylabel(<span class="string">'Elo-rating'</span>,<span class="string">'FontSize'</span>,12)
<span class="comment">% l=size(EloMatrixOrder,1);</span>
<span class="comment">% x=cell2mat(EloMatrixOrder(l-2,IndexEvents));</span>
<span class="comment">% y=cell2mat(EloMatrixOrder(l-2,i));</span>
<span class="comment">% text(x,y,EloMatrixOrder(1,i),'FontSize',12)</span>
<span class="keyword">end</span>

plot(cell2mat(EloMatrixOrder(length(IndexFirstDay),IndexEvents))*ones(1,length([600 1400])),[600 1400],<span class="string">'--'</span>,<span class="string">'LineWidth'</span>,2);
<span class="comment">%</span>
<span class="comment">%  else</span>
<span class="comment">%   IndexEvents=find(strcmp(EloMatrixOrder(1,:),'Events')==1);</span>

<span class="comment">%</span>
<span class="comment">% for i=4:length(Ranking(:,1))+3</span>
<span class="comment">% p=plot(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexEvents)),cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,i)));</span>
<span class="comment">% hold all;</span>
<span class="comment">% title('Elo-rating per event','FontSize',12)</span>
<span class="comment">% xlabel('Events','FontSize',12)</span>
<span class="comment">% ylabel('Elo-rating','FontSize',12)</span>
<span class="comment">% l=size(EloMatrixOrder,1);</span>
<span class="comment">% x=cell2mat(EloMatrixOrder(l-2,IndexEvents));</span>
<span class="comment">% y=cell2mat(EloMatrixOrder(l-2,i));</span>
<span class="comment">% text(x,y,EloMatrixOrder(1,i),'FontSize',12)</span>
<span class="comment">% end</span>
<span class="comment">%</span>
</pre><h2>-----------------Plot interaction matrix-first mouse dominant------------<a name="35"></a></h2><pre class="codeinput"> IndexMatrix=find(strcmp(<span class="string">'Interaction Matrix for each day (Chasing/being Chasing)'</span>,raw(:,1))==1);


 set(0,<span class="string">'CurrentFigure'</span>,temp17)
<span class="keyword">for</span> t=1:Days  <span class="comment">%Loop on the days</span>


 subplot(length(SelectedExperiments),Days,t+(i-1)*Days)
mat=raw(IndexMatrix:NumberMice+IndexMatrix-1,3+(t-1)*(NumberMice+1):NumberMice+2+(t-1)*(NumberMice+1));
imagesc(cell2mat(mat));            <span class="comment">%# Create a colored plot of the matrix values</span>
colormap(flipud(gray));
headers=(raw(IndexMatrix:NumberMice+IndexMatrix-1,2))';
headers=char(headers);
<span class="comment">% textStrings = num2str(mat(:),'%0.2f');  %# Create strings from the matrix values</span>
<span class="comment">% textStrings = strtrim(cellstr(textStrings));  %# Remove any space padding</span>
[x,y] = meshgrid(1:NumberMice);   <span class="comment">%# Create x and y coordinates for the strings</span>
<span class="comment">% hStrings = text(x(:),y(:),textStrings(:),...      %# Plot the strings</span>
<span class="comment">%                 'HorizontalAlignment','center');</span>

hStrings = text(x(:),y(:),mat(:),<span class="keyword">...</span><span class="comment">      %# Plot the strings</span>
                <span class="string">'HorizontalAlignment'</span>,<span class="string">'center'</span>);

<span class="comment">% midValue = mean(get(gca,'CLim'));  %# Get the middle value of the color range</span>
<span class="comment">% textColors = repmat(mat(:) &gt; midValue,1,3);  %# Choose white or black for the</span>
<span class="comment">%                                              %#   text color of the strings so</span>
<span class="comment">%                                              %#   they can be easily seen over</span>
<span class="comment">%                                              %#   the background color</span>
<span class="comment">% set(hStrings,{'Color'},num2cell(textColors,2));  %# Change the text colors</span>
<span class="comment">%</span>
set(gca,<span class="string">'XTick'</span>,1:NumberMice,<span class="keyword">...</span><span class="comment">                         %# Change the axes tick marks</span>
        <span class="string">'XTickLabel'</span>,headers(:,7:end),<span class="keyword">...</span><span class="comment">  %#   and tick labels</span>
        <span class="string">'YTick'</span>,1:NumberMice,<span class="keyword">...</span>
        <span class="string">'YTickLabel'</span>,headers(:,7:end),<span class="keyword">...</span>
        <span class="string">'TickLength'</span>,[0 0],<span class="string">'FontSize'</span>,8);
title(strcat(char(SelectedExperiments(i)),<span class="string">'Day '</span>,num2str(t)))
xlabel(<span class="string">'Being chasing'</span>);
ylabel(<span class="string">'Chasing'</span>);
<span class="keyword">end</span>
</pre><pre class="codeinput">waitbar(i/length(SelectedExperiments))
</pre><pre class="codeinput"><span class="keyword">end</span>
close(hbar)
</pre><pre class="codeoutput error">Not enough input arguments.

Error in PlotParameters (line 138)
for i=1:length(SelectedExperiments)
</pre><h2>To save into the excel files<a name="39"></a></h2><pre class="codeinput"><span class="comment">% print(temp,'-dpng',tempfigfile);</span>
print(temp,<span class="string">'-dpng'</span>,tempfigfile);
print(temp1,<span class="string">'-dpng'</span>,tempfigfile1);
print(temp2,<span class="string">'-dpng'</span>,tempfigfile2);
print(temp3,<span class="string">'-dpng'</span>,tempfigfile3);
print(temp4,<span class="string">'-dpng'</span>,tempfigfile4);
print(temp5,<span class="string">'-dpng'</span>,tempfigfile5);
print(temp6,<span class="string">'-dpng'</span>,tempfigfile6);
print(temp7,<span class="string">'-dpng'</span>,tempfigfile7);
print(temp8,<span class="string">'-dpng'</span>,tempfigfile8);
print(temp9,<span class="string">'-dpng'</span>,tempfigfile9);
print(temp10,<span class="string">'-dpng'</span>,tempfigfile10);
print(temp11,<span class="string">'-dpng'</span>,tempfigfile11);
print(temp12,<span class="string">'-dpng'</span>,tempfigfile12);
print(temp13,<span class="string">'-dpng'</span>,tempfigfile13);
print(temp14,<span class="string">'-dpng'</span>,tempfigfile14);
print(temp15,<span class="string">'-dpng'</span>,tempfigfile15);
print(temp16,<span class="string">'-dpng'</span>,tempfigfile16);
print(temp17,<span class="string">'-dpng'</span>,tempfigfile17);
print(temp18,<span class="string">'-dpng'</span>,tempfigfile18);
print(temp19,<span class="string">'-dpng'</span>,tempfigfile19);
print(temp20,<span class="string">'-dpng'</span>,tempfigfile20);
print(temp21,<span class="string">'-dpng'</span>,tempfigfile21);
print(temp22,<span class="string">'-dpng'</span>,tempfigfile22);
print(temp23,<span class="string">'-dpng'</span>,tempfigfile23);
print(temp24,<span class="string">'-dpng'</span>,tempfigfile24);
print(temp25,<span class="string">'-dpng'</span>,tempfigfile25);
print(temp26,<span class="string">'-dpng'</span>,tempfigfile26);
</pre><h2>Activate excel file<a name="40"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

<span class="comment">% Shapes.AddPicture(tempfigfile,0,1,50,18,300,235);</span>
Shapes.AddPicture(tempfigfile,0,1,50,18,1000,500);

graphSheet.Name=<span class="string">'RunningTime(% of time)'</span>;
exl2.visible=1;


invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="41"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile1,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'WalkingTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="42"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile2,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'StaticTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="43"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile3,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'movementTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="44"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile4,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'sleepingSumTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="45"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile5,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'eatingSumTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="46"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile6,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'drinkingSumTime(% of time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="47"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile7,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'hidingSumTime'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="48"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile8,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'ArenaSumTime'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="49"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile9,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'CenterTimeAlone'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="50"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile10,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'chasing all'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="51"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile11,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'being chased all'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="52"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile12,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Chasing-beingChasing'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="53"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile13,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'DistPairs all(average (cm))'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="54"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile14,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Average velocity'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>Activate excel file<a name="55"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile15,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'togetherAll'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% Activate excel file<a name="56"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile16,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Elorating'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="57"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile17,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Interaction Matrix'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="59"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile18,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Running(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="60"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile19,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Walking(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% %% Activate excel file<a name="61"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile20,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Static(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="62"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile21,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Movement(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="63"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile22,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Eating(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="64"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile23,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Drinking(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="65"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile24,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'Alone(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="66"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile25,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'InZone(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><h2>%% %% Activate excel file<a name="67"></a></h2><pre class="codeinput">Excel = actxserver(<span class="string">'Excel.Application'</span>);
Excel.DisplayAlerts = false;
ResultFile=Filename;
ResultFile1=strcat(<span class="string">'AddGraphs'</span>,Filename);

Workbook=invoke(Excel.Workbooks,<span class="string">'Open'</span>,ResultFile);
set(Excel,<span class="string">'Visible'</span>,1);
graphSheet=invoke(Workbook.Sheets,<span class="string">'Add'</span>);
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile26,0,1,50,18,1000,500);
graphSheet.Name=<span class="string">'OutZone(% active time)'</span>;
exl2.visible=1;

invoke(Workbook,<span class="string">'SaveAs'</span>,ResultFile);
invoke(Excel,<span class="string">'Quit'</span>);
close(<span class="string">'gcf'</span>)
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
function [ output_args ] =PlotParameters(Filename,SelectedExperiments,FilenameChasingData1)
global h

%% REPLACE_WITH_DASH_DASHVariablesREPLACE_WITH_DASH_DASH
NumberMice=str2num(get(h.editMouse,'string'));%number of mice to plot
Days=str2num(get(h.editDays,'string'))%number of days to plot



cc=jet(NumberMice);%for getting colors


%% 

%Plot parameters-Add to excel file
%REPLACE_WITH_DASH_DASHfor saving into excel file create temp file for each expREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
tempfigfile=[tempname '.png'];
temp=figure;
set (temp, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile1=[tempname '.png'];
temp1=figure;
set (temp1, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile2=[tempname '.png'];
temp2=figure;
set (temp2, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile3=[tempname '.png'];
temp3=figure;
set (temp3, 'Units', 'normalized', 'Position', [0,0,1,1]);


tempfigfile4=[tempname '.png'];
temp4=figure;
set (temp4, 'Units', 'normalized', 'Position', [0,0,1,1]);


tempfigfile5=[tempname '.png'];
temp5=figure;
set (temp5, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile6=[tempname '.png'];
temp6=figure;
set (temp6, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile7=[tempname '.png'];
temp7=figure;
set (temp7, 'Units', 'normalized', 'Position', [0,0,1,1]);


tempfigfile8=[tempname '.png'];
temp8=figure;
set (temp8, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile9=[tempname '.png'];
temp9=figure;
set (temp9, 'Units', 'normalized', 'Position', [0,0,1,1]);


tempfigfile10=[tempname '.png'];
temp10=figure;
set (temp10, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile11=[tempname '.png'];
temp11=figure;
set (temp11, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile12=[tempname '.png'];
temp12=figure;
set (temp12, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile13=[tempname '.png'];
temp13=figure;
set (temp13, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile14=[tempname '.png'];
temp14=figure;
set (temp14, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile15=[tempname '.png'];
temp15=figure;
set (temp15, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile16=[tempname '.png'];
temp16=figure;
set (temp16, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile17=[tempname '.png'];
temp17=figure;
set (temp17, 'Units', 'normalized', 'Position', [0,0,1,1]);
% 
tempfigfile18=[tempname '.png'];
temp18=figure;
set (temp18, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile19=[tempname '.png'];
temp19=figure;
set (temp19, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile20=[tempname '.png'];
temp20=figure;
set (temp20, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile21=[tempname '.png'];
temp21=figure;
set (temp21, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile22=[tempname '.png'];
temp22=figure;
set (temp22, 'Units', 'normalized', 'Position', [0,0,1,1]);

tempfigfile23=[tempname '.png'];
temp23=figure;
set (temp23, 'Units', 'normalized', 'Position', [0,0,1,1]);


tempfigfile24=[tempname '.png'];
temp24=figure;
set (temp24, 'Units', 'normalized', 'Position', [0,0,1,1]);



tempfigfile25=[tempname '.png'];
temp25=figure;
set (temp25, 'Units', 'normalized', 'Position', [0,0,1,1]);



tempfigfile26=[tempname '.png'];
temp26=figure;
set (temp26, 'Units', 'normalized', 'Position', [0,0,1,1]);

%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Read each sheet and create a figure for each parameterREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
clear raw;

hbar = waitbar(0,'Please wait...');
for i=1:length(SelectedExperiments)
    sheet=char(SelectedExperiments(i))
 [num,txt,raw]=xlsread(Filename,sheet);   
 %% Find limits of each parameter
 %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHRunning parameter
 
 IndexRunning=find(strcmp('RunningTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp)
 if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
 end
hfig=bar(cell2mat(raw(IndexRunning:IndexRunning+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;

xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexRunning:IndexRunning+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('RunningTime(% of time)')
 
 %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHRunning parameter ActiveREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
 
 IndexRunningA=find(strcmp('RunningTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp18)
 if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
 end
hfig=bar(cell2mat(raw(IndexRunningA:IndexRunningA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;

xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexRunningA:IndexRunningA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('RunningTime(% of Active time)')

   %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHWalking parameter
 
 IndexWalking=find(strcmp('WalkingTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp1)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end


hfig=bar(cell2mat(raw(IndexWalking:IndexWalking+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)));
l=strcat('''',raw(IndexWalking:IndexWalking+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('WalkingTime(% of time)')

%%    %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHWalking parameter of active time
 
 IndexWalkingA=find(strcmp('WalkingTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp19)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end


hfig=bar(cell2mat(raw(IndexWalkingA:IndexWalkingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)));
l=strcat('''',raw(IndexWalkingA:IndexWalkingA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('WalkingTime(% of active time)')

   %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHStatic parameter of exp timeREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
 
 IndexStatic=find(strcmp('StaticTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp2)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexStatic:IndexStatic+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexStatic:IndexStatic+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('StaticTime(% of time))')

   %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHStatic parameter of active timeREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
 
 IndexStaticA=find(strcmp('StaticTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp20)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexStaticA:IndexStaticA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexStaticA:IndexStaticA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('StaticTime(% of active time)')

%%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHmovement parameter of active timeREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
 
 IndexMovementA=find(strcmp('movementTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp21)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexMovementA:IndexMovementA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexMovementA:IndexMovementA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('movementTime(% of active time)')
    
%%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHmovement parameter of active timeREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
 
 IndexMovement=find(strcmp('movementTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp3)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexMovement:IndexMovement+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexMovement:IndexMovement+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('movementTime(% of time)')
    

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHSleeping parameter
 
 IndexSleeping=find(strcmp('sleepingSumTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp4)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end


hfig=bar(cell2mat(raw(IndexSleeping:IndexSleeping+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexSleeping:IndexSleeping+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('sleepingSumTime(% of time)')



%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHEating parameter
 
 IndexEating=find(strcmp('eatingSumTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp5)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexEating:IndexEating+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexEating:IndexEating+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('eatingSumTime(% of time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHEating parameter in Active Time
 
 IndexEatingA=find(strcmp('eatingSumTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp22)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexEatingA:IndexEatingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexEatingA:IndexEatingA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('eatingSumTime(% of time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHDrinking parameter
 
 IndexDrinking=find(strcmp('drinkingSumTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp6)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexDrinking:IndexDrinking+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexDrinking:IndexDrinking+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('drinkingSumTime(% of time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHDrinking parameter ACTIVE TIME
 
 IndexDrinkingA=find(strcmp('drinkingSumTimeActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp23)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexDrinkingA:IndexDrinkingA+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexDrinkingA:IndexDrinkingA+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('drinkingSumTime(% of Active time)')
%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHHiding parameter REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
 
 IndexHiding=find(strcmp('hidingSumTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp7)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end


hfig=bar(cell2mat(raw(IndexHiding:IndexHiding+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexHiding:IndexHiding+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('hidingSumTime(% of time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHArena parameter
 
 IndexArena=find(strcmp('ArenaSumTime(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp8)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexArena:IndexArena+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexArena:IndexArena+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('ArenaSumTime(% of time)')


%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHalone parameter
 
 IndexAlone=find(strcmp('CenterTimeAlone(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp9)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexAlone:IndexAlone+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexAlone:IndexAlone+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('CenterTimeAlone(% of time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHalone parameter in active time
 
 IndexAlone=find(strcmp('CenterTimeAloneActive(% of Active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp24)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexAlone:IndexAlone+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexAlone:IndexAlone+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('CenterTimeAloneActive(% of Active time)')

%% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHchasing parameter
 
 IndexChasing=find(strcmp('chasing all (N events)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp10)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexChasing:IndexChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexChasing:IndexChasing+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('chasing all (N events)')

   %% %%  %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH being chasing parameter
 
 IndexBeingChasing=find(strcmp('being chased all(N events)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp11)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw(IndexBeingChasing:IndexBeingChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw(IndexBeingChasing:IndexBeingChasing+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('being chased all(N events)')

%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHChasing + being chasing

 
 IndexBeingPlusChasing=find(strcmp('Chasing plus being chasing all(N events)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp12)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw( IndexBeingPlusChasing: IndexBeingPlusChasing+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexBeingPlusChasing: IndexBeingPlusChasing+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('Chasing plus being chasing all(N events)')


%% %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHDist pairs

 
 IndexDistance=find(strcmp('DistPairs all(average (cm))',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp13)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end
  
hfig=bar(cell2mat(raw( IndexDistance: IndexDistance+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexDistance: IndexDistance+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('DistPairs all(average (cm))')

%% %% %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHVelocity

 
 IndexVelocity=find(strcmp('Average velocity (average (cm/sec))',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp14)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw( IndexVelocity: IndexVelocity+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexVelocity: IndexVelocity+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('Average velocity (average (cm/sec))')


%% %% %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHtogether allREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

 
 IndexTogether=find(strcmp('togetherAll(% of time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp15)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexTogether: IndexTogether+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('togetherAll(% of time)')

%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Inside active zoneREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

 IndexTogether=find(strcmp('InsideZoneTime(% of active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp25)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexTogether: IndexTogether+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('InsideZoneTime(% of active time)')


%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Outside active zoneREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

 IndexTogether=find(strcmp('OutsideZoneTime(% of active time)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp26)
 
  if length(SelectedExperiments)==1
     subplot(1,1,1)
 else
subplot(round(length(SelectedExperiments)/3),3,i)
  end

hfig=bar(cell2mat(raw( IndexTogether: IndexTogether+NumberMice-1,3:3+Days-1))');
hfig(1).Parent.Parent.Colormap=cc;
xlabel(char(SelectedExperiments(i)))
l=strcat('''',raw( IndexTogether: IndexTogether+NumberMice-1,2),'''');
legend(hfig,l,'Location','northwestoutside')

title('OutsideZoneTime(% of active time)')



%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHInsert Elo rating graphs per each experimentREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHLoad the dataREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
set(0,'CurrentFigure',temp16)
FilenameChasingData=strcat(FilenameChasingData1,SelectedExperiments(i),'\','Data','\','ChasingResults','\',strcat(SelectedExperiments(i),'_ChasingResults.xlsx'));

sheet='Elo-rating All Events';
[num txt EloMatrixOrder]=xlsread(char(FilenameChasingData),sheet);

sheet1='Elo-rating per day order';
[num txt EloeDayTotalOrder]=xlsread(char(FilenameChasingData),sheet1);

sheet2='Ranking';
[num txt Ranking]=xlsread(char(FilenameChasingData),sheet2);

 IndEAD=find(strcmp('Mean Elorating per day',raw(:,1))==1);

subplot(length(SelectedExperiments),3,i+1) %plot Elo per day
for j=2:length(Ranking(:,1))+1
    T=char(EloeDayTotalOrder(1,j));
plot(cell2mat(EloeDayTotalOrder(2:end,1)),cell2mat(EloeDayTotalOrder(2:end,j)),'-*','MarkerSize',12,'DisplayName',T,'Color',cc(j-1,:));
% legend('-DynamicLegend','Location','northeastoutside');
hold all;
title('Last Event of Elo-rating per  day','FontSize',12)
xlabel('Days','FontSize',12)
ylabel('Elo-rating','FontSize',12)

end  


hold on;
raw1=[];
%add initial point 0 is 1000
raw1(1:length(Ranking(:,1)),1)=1000;
raw1(:,2:2+Days-1)=cell2mat(raw(IndEAD:IndEAD+length(Ranking(:,1))-1,3:3+Days-1));

subplot(length(SelectedExperiments),3,i+2) %plot Elo per day by assuming the average
for j=2:length(Ranking(:,1))+1
    T=char(EloeDayTotalOrder(1,j));



plot(cell2mat(EloeDayTotalOrder(2:end,1)),raw1(j-1,1:Days+1),'-*','MarkerSize',12,'DisplayName',T,'Color',cc(j-1,:));
% legend('-DynamicLegend','Location','northeastoutside');
hold all;
title('Average Elo-rating per day','FontSize',12)
xlabel('Days','FontSize',12)
ylabel('Elo-rating','FontSize',12)

end  


hold on;



subplot(length(SelectedExperiments),3,i)%plot per event
%find Events column
IndexEvents=find(strcmp(EloMatrixOrder(1,:),'Events')==1);
IndexDay=find(strcmp(EloMatrixOrder(1,:),'Day')==1);
IndexFirstDay=find(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexDay))==1);
%find where the first day finished

for j=4:length(Ranking(:,1))+3
    
    T=char(EloMatrixOrder(1,j));
plot(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexEvents)),cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,j)),'DisplayName',T,'Color',cc(j-3,:));
legend('-DynamicLegend','Location','northeastoutside');
hold all;
title(strcat(char(SelectedExperiments(i)),'Elo-rating per event'),'FontSize',12)
xlabel('Events','FontSize',12)
ylabel('Elo-rating','FontSize',12)
% l=size(EloMatrixOrder,1);
% x=cell2mat(EloMatrixOrder(l-2,IndexEvents));
% y=cell2mat(EloMatrixOrder(l-2,i));
% text(x,y,EloMatrixOrder(1,i),'FontSize',12)
end 

plot(cell2mat(EloMatrixOrder(length(IndexFirstDay),IndexEvents))*ones(1,length([600 1400])),[600 1400],'REPLACE_WITH_DASH_DASH','LineWidth',2);
% 
%  else
%   IndexEvents=find(strcmp(EloMatrixOrder(1,:),'Events')==1);

% 
% for i=4:length(Ranking(:,1))+3
% p=plot(cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,IndexEvents)),cell2mat(EloMatrixOrder(2:size(EloMatrixOrder,1)-1,i)));
% hold all;
% title('Elo-rating per event','FontSize',12)
% xlabel('Events','FontSize',12)
% ylabel('Elo-rating','FontSize',12)
% l=size(EloMatrixOrder,1);
% x=cell2mat(EloMatrixOrder(l-2,IndexEvents));
% y=cell2mat(EloMatrixOrder(l-2,i));
% text(x,y,EloMatrixOrder(1,i),'FontSize',12)
% end 
%   
%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Plot interaction matrix-first mouse dominantREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
 
 IndexMatrix=find(strcmp('Interaction Matrix for each day (Chasing/being Chasing)',raw(:,1))==1);
 

 set(0,'CurrentFigure',temp17)
for t=1:Days  %Loop on the days
   
  
 subplot(length(SelectedExperiments),Days,t+(i-1)*Days)
mat=raw(IndexMatrix:NumberMice+IndexMatrix-1,3+(t-1)*(NumberMice+1):NumberMice+2+(t-1)*(NumberMice+1));
imagesc(cell2mat(mat));            %# Create a colored plot of the matrix values
colormap(flipud(gray));
headers=(raw(IndexMatrix:NumberMice+IndexMatrix-1,2))';
headers=char(headers);
% textStrings = num2str(mat(:),'%0.2f');  %# Create strings from the matrix values
% textStrings = strtrim(cellstr(textStrings));  %# Remove any space padding
[x,y] = meshgrid(1:NumberMice);   %# Create x and y coordinates for the strings
% hStrings = text(x(:),y(:),textStrings(:),...      %# Plot the strings
%                 'HorizontalAlignment','center');

hStrings = text(x(:),y(:),mat(:),...      %# Plot the strings
                'HorizontalAlignment','center');

% midValue = mean(get(gca,'CLim'));  %# Get the middle value of the color range
% textColors = repmat(mat(:) > midValue,1,3);  %# Choose white or black for the
%                                              %#   text color of the strings so
%                                              %#   they can be easily seen over
%                                              %#   the background color
% set(hStrings,{'Color'},num2cell(textColors,2));  %# Change the text colors
% 
set(gca,'XTick',1:NumberMice,...                         %# Change the axes tick marks
        'XTickLabel',headers(:,7:end),...  %#   and tick labels
        'YTick',1:NumberMice,...
        'YTickLabel',headers(:,7:end),...
        'TickLength',[0 0],'FontSize',8);
title(strcat(char(SelectedExperiments(i)),'Day ',num2str(t)))
xlabel('Being chasing');
ylabel('Chasing');
end

%% 
waitbar(i/length(SelectedExperiments))
end
close(hbar)

%% 




















%% To save into the excel files

% print(temp,'-dpng',tempfigfile);
print(temp,'-dpng',tempfigfile);
print(temp1,'-dpng',tempfigfile1);
print(temp2,'-dpng',tempfigfile2);
print(temp3,'-dpng',tempfigfile3);
print(temp4,'-dpng',tempfigfile4);
print(temp5,'-dpng',tempfigfile5);
print(temp6,'-dpng',tempfigfile6);
print(temp7,'-dpng',tempfigfile7);
print(temp8,'-dpng',tempfigfile8);
print(temp9,'-dpng',tempfigfile9);
print(temp10,'-dpng',tempfigfile10);
print(temp11,'-dpng',tempfigfile11);
print(temp12,'-dpng',tempfigfile12);
print(temp13,'-dpng',tempfigfile13);
print(temp14,'-dpng',tempfigfile14);
print(temp15,'-dpng',tempfigfile15);
print(temp16,'-dpng',tempfigfile16);
print(temp17,'-dpng',tempfigfile17);
print(temp18,'-dpng',tempfigfile18);
print(temp19,'-dpng',tempfigfile19);
print(temp20,'-dpng',tempfigfile20);
print(temp21,'-dpng',tempfigfile21);
print(temp22,'-dpng',tempfigfile22);
print(temp23,'-dpng',tempfigfile23);
print(temp24,'-dpng',tempfigfile24);
print(temp25,'-dpng',tempfigfile25);
print(temp26,'-dpng',tempfigfile26);
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

% Shapes.AddPicture(tempfigfile,0,1,50,18,300,235);
Shapes.AddPicture(tempfigfile,0,1,50,18,1000,500);

graphSheet.Name='RunningTime(% of time)';
exl2.visible=1;


invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile1,0,1,50,18,1000,500);
graphSheet.Name='WalkingTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile2,0,1,50,18,1000,500);
graphSheet.Name='StaticTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile3,0,1,50,18,1000,500);
graphSheet.Name='movementTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile4,0,1,50,18,1000,500);
graphSheet.Name='sleepingSumTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile5,0,1,50,18,1000,500);
graphSheet.Name='eatingSumTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile6,0,1,50,18,1000,500);
graphSheet.Name='drinkingSumTime(% of time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile7,0,1,50,18,1000,500);
graphSheet.Name='hidingSumTime';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');

Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile8,0,1,50,18,1000,500);
graphSheet.Name='ArenaSumTime';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile9,0,1,50,18,1000,500);
graphSheet.Name='CenterTimeAlone';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile10,0,1,50,18,1000,500);
graphSheet.Name='chasing all';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile11,0,1,50,18,1000,500);
graphSheet.Name='being chased all';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile12,0,1,50,18,1000,500);
graphSheet.Name='Chasing-beingChasing';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile13,0,1,50,18,1000,500);
graphSheet.Name='DistPairs all(average (cm))';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile14,0,1,50,18,1000,500);
graphSheet.Name='Average velocity';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile15,0,1,50,18,1000,500);
graphSheet.Name='togetherAll';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile16,0,1,50,18,1000,500);
graphSheet.Name='Elorating';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile17,0,1,50,18,1000,500);
graphSheet.Name='Interaction Matrix';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% 
%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile18,0,1,50,18,1000,500);
graphSheet.Name='Running(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile19,0,1,50,18,1000,500);
graphSheet.Name='Walking(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
%% %% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile20,0,1,50,18,1000,500);
graphSheet.Name='Static(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile21,0,1,50,18,1000,500);
graphSheet.Name='Movement(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile22,0,1,50,18,1000,500);
graphSheet.Name='Eating(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile23,0,1,50,18,1000,500);
graphSheet.Name='Drinking(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile24,0,1,50,18,1000,500);
graphSheet.Name='Alone(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile25,0,1,50,18,1000,500);
graphSheet.Name='InZone(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')

%% %% %% Activate excel file
Excel = actxserver('Excel.Application');
Excel.DisplayAlerts = false; 
ResultFile=Filename;
ResultFile1=strcat('AddGraphs',Filename);

Workbook=invoke(Excel.Workbooks,'Open',ResultFile);
set(Excel,'Visible',1);
graphSheet=invoke(Workbook.Sheets,'Add');
Shapes=graphSheet.Shapes;

Shapes.AddPicture(tempfigfile26,0,1,50,18,1000,500);
graphSheet.Name='OutZone(% active time)';
exl2.visible=1;

invoke(Workbook,'SaveAs',ResultFile);
invoke(Excel,'Quit');
close('gcf')
end


##### SOURCE END #####
--></body></html>