
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>MiceID</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-06-01"><meta name="DC.source" content="MiceID.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Parameters</a></li><li><a href="#3">Creation of a figure</a></li><li><a href="#4">Create pushbutton</a></li><li><a href="#5">Add panel to corroborate coordinates</a></li><li><a href="#6">-----------Add popup menu--------------------</a></li><li><a href="#7">%% Save the data into excel file with experiment name and save</a></li><li><a href="#8">----------------------Create pushbutton to open a word document which explains the gui---</a></li><li><a href="#10">auxiliary functions</a></li><li><a href="#11">Read popup menu</a></li><li><a href="#13">Consider if to use default or to change</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> MouseID(~,~)
</pre><h2>Parameters<a name="2"></a></h2><pre class="codeinput"><span class="keyword">global</span> ChipsID
<span class="keyword">global</span> h
<span class="keyword">global</span> Image6
<span class="keyword">global</span> Image5
</pre><h2>Creation of a figure<a name="3"></a></h2><pre class="codeinput">h.Layout= figure(<span class="string">'Visible'</span>,<span class="string">'on'</span>,<span class="string">'MenuBar'</span>,<span class="string">'None'</span>,<span class="string">'NumberTitle'</span>,<span class="string">'off'</span>,<span class="keyword">...</span>
                                   <span class="string">'Toolbar'</span>,<span class="string">'none'</span>,<span class="string">'HandleVisibility'</span>,<span class="string">'callback'</span>,<span class="keyword">...</span>
                                    <span class="string">'Color'</span>,get(0,<span class="string">'defaultuicontrolbackgroundcolor'</span>),<span class="keyword">...</span>
                                    <span class="string">'name'</span>,<span class="string">'Set mice identity and arena coordinates'</span>,<span class="keyword">...</span>
                                    <span class="string">'Position'</span>,[320 320 900 300]);
</pre><img vspace="5" hspace="5" src="MiceID_01.png" alt=""> <h2>Create pushbutton<a name="4"></a></h2><pre class="codeinput"> uicontrol(h.Layout,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'String'</span>,<span class="string">'1- Open the folder called Data'</span>,<span class="string">'position'</span>,[10,260,200,30],<span class="string">'callback'</span>,@LoadData)
 h.edit1=uicontrol(h.Layout,<span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">' '</span>,<span class="string">'position'</span>,[220,260,400,30]);
<span class="comment">%Create edit for experiment name</span>
 uicontrol(h.Layout,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'2- Experiment name '</span>,<span class="string">'position'</span>,[20,230,100,30]);
h.edit2=uicontrol(h.Layout,<span class="string">'Style'</span>,<span class="string">'edit'</span>,<span class="string">'String'</span>,<span class="string">'Exp50L'</span>,<span class="string">'position'</span>,[20,210,100,30]);

 <span class="comment">%Create pushbotton to load the table</span>

uicontrol(h.Layout,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'String'</span>,<span class="string">'4- Load the table to select mice ID'</span>,<span class="string">'position'</span>,[10,100,200,40],<span class="string">'callback'</span>,@TableFcn)
</pre><img vspace="5" hspace="5" src="MiceID_02.png" alt=""> <h2>Add panel to corroborate coordinates<a name="5"></a></h2><pre class="codeinput">h.Coordinates=uipanel(<span class="string">'Parent'</span>,h.Layout,<span class="string">'Title'</span>,<span class="string">'3- Arena coordinates'</span>,<span class="string">'FontSize'</span>,9,<span class="string">'ForegroundColor'</span>,<span class="string">'magenta'</span>,<span class="string">'Units'</span>,<span class="string">'pixels'</span>,<span class="string">'Position'</span>,[150,200,650,60]);
uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'String'</span>,<span class="string">'Corroborate the arenas coordinates'</span>,<span class="string">'position'</span>,[10,10,200,30],<span class="string">'foreground'</span>,<span class="string">'red'</span>,<span class="string">'callback'</span>,@CorroborateArenaCoord);
</pre><img vspace="5" hspace="5" src="MiceID_03.png" alt=""> <h2>-----------Add popup menu--------------------<a name="6"></a></h2><pre class="codeinput">h.popup1=uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'popup'</span>, <span class="string">'String'</span>,{<span class="string">'Default'</span>,<span class="string">'Change'</span>},<span class="string">'position'</span>,[210,1,70,25],<span class="string">'foreground'</span>,<span class="string">'blue'</span>);
uicontrol(h.Coordinates,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'Corners '</span>,<span class="string">'position'</span>,[210,30,50,15]);

h.popup2=uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'popup'</span>, <span class="string">'String'</span>,{<span class="string">'Default'</span>,<span class="string">'Change'</span>},<span class="string">'position'</span>,[290,1,70,25],<span class="string">'foreground'</span>,<span class="string">'blue'</span>);
uicontrol(h.Coordinates,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'Eating'</span>,<span class="string">'position'</span>,[290,30,50,15]);

h.popup3=uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'popup'</span>, <span class="string">'String'</span>,{<span class="string">'Default'</span>,<span class="string">'Change'</span>},<span class="string">'position'</span>,[370,1,70,25],<span class="string">'foreground'</span>,<span class="string">'blue'</span>);
uicontrol(h.Coordinates,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'Drink loc.'</span>,<span class="string">'position'</span>,[370,30,50,15]);

uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'String'</span>,<span class="string">' '</span>,<span class="string">'position'</span>,[600,5,40,30],<span class="string">'foreground'</span>,<span class="string">'blue'</span>,<span class="string">'callback'</span>,@ReadPopup,<span class="string">'cdata'</span>,Image5);

h.popup4=uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'popup'</span>, <span class="string">'String'</span>,{<span class="string">'Default'</span>,<span class="string">'Change'</span>},<span class="string">'position'</span>,[444,1,70,25],<span class="string">'foreground'</span>,<span class="string">'blue'</span>);
uicontrol(h.Coordinates,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'Bridge L.'</span>,<span class="string">'position'</span>,[444,30,50,15]);

h.popup5=uicontrol(h.Coordinates,<span class="string">'Style'</span>, <span class="string">'popup'</span>, <span class="string">'String'</span>,{<span class="string">'Default'</span>,<span class="string">'Change'</span>},<span class="string">'position'</span>,[515,1,70,25],<span class="string">'foreground'</span>,<span class="string">'blue'</span>);
uicontrol(h.Coordinates,<span class="string">'Style'</span>,<span class="string">'text'</span>,<span class="string">'String'</span>,<span class="string">'Bridge N.'</span>,<span class="string">'position'</span>,[515,30,50,15]);
</pre><img vspace="5" hspace="5" src="MiceID_04.png" alt=""> <h2>%% Save the data into excel file with experiment name and save<a name="7"></a></h2><pre class="codeinput">uicontrol(h.Layout,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>, <span class="string">'String'</span>,<span class="string">'5- Save ID to excel'</span>,<span class="string">'position'</span>,[700,10,200,30],<span class="string">'callback'</span>,@SaveTableInExcel)
</pre><img vspace="5" hspace="5" src="MiceID_05.png" alt=""> <h2>----------------------Create pushbutton to open a word document which explains the gui---<a name="8"></a></h2><pre class="codeinput"> uicontrol(h.Layout,<span class="string">'Style'</span>, <span class="string">'pushbutton'</span>,<span class="string">'String'</span>, <span class="string">''</span>,<span class="string">'position'</span>,[850,230,40,60],<span class="string">'FontSize'</span>,9,<span class="string">'ForegroundColor'</span>,<span class="string">'blue'</span>,<span class="string">'callback'</span>,@OpenWordDocument,<span class="string">'cdata'</span>,Image6)
</pre><img vspace="5" hspace="5" src="MiceID_06.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2>auxiliary functions<a name="10"></a></h2><pre class="codeinput"><span class="keyword">function</span> OpenWordDocument(~,~)
<span class="keyword">global</span> root_folder
<span class="comment">%This function open the word document with all the information</span>

winopen(strcat(root_folder,<span class="string">'HelpDocuments'</span>,<span class="string">'\'</span>,<span class="string">'Module Set mice identity.docx'</span>));

<span class="keyword">end</span>
</pre><h2>Read popup menu<a name="11"></a></h2><pre class="codeinput"><span class="keyword">function</span> ReadPopup(~,~)
</pre><pre class="codeinput"><span class="keyword">global</span> h
conditions=zeros(1,5);
</pre><h2>Consider if to use default or to change<a name="13"></a></h2><pre class="codeinput">list=get(h.popup1,<span class="string">'String'</span>);
idx=get(h.popup1,<span class="string">'Value'</span>);
option=list(idx);

<span class="keyword">if</span> strcmp(option,<span class="string">'Change'</span>)==1
    conditions(1,1)=1;
<span class="keyword">end</span>

list=get(h.popup2,<span class="string">'String'</span>);
idx=get(h.popup2,<span class="string">'Value'</span>);
option=list(idx);
<span class="keyword">if</span> strcmp(option,<span class="string">'Change'</span>)==1
    conditions(1,2)=1;
<span class="keyword">end</span>


list=get(h.popup3,<span class="string">'String'</span>);
idx=get(h.popup3,<span class="string">'Value'</span>);
option=list(idx);
<span class="keyword">if</span> strcmp(option,<span class="string">'Change'</span>)==1
    conditions(1,3)=1;
<span class="keyword">end</span>

list=get(h.popup4,<span class="string">'String'</span>);
idx=get(h.popup4,<span class="string">'Value'</span>);
option=list(idx);
<span class="keyword">if</span> strcmp(option,<span class="string">'Change'</span>)==1
    conditions(1,4)=1;
<span class="keyword">end</span>



list=get(h.popup5,<span class="string">'String'</span>);
idx=get(h.popup5,<span class="string">'Value'</span>);
option=list(idx);
<span class="keyword">if</span> strcmp(option,<span class="string">'Change'</span>)==1
    conditions(1,5)=1;
<span class="keyword">end</span>
RearrangeArenaCoord(conditions);
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
function MouseID(~,~)
%% Parameters
global ChipsID
global h
global Image6
global Image5
%% Creation of a figure
h.Layout= figure('Visible','on','MenuBar','None','NumberTitle','off',...
                                   'Toolbar','none','HandleVisibility','callback',...
                                    'Color',get(0,'defaultuicontrolbackgroundcolor'),...
                                    'name','Set mice identity and arena coordinates',...
                                    'Position',[320 320 900 300]);
                                

 

                                
 %% Create pushbutton
 uicontrol(h.Layout,'Style', 'pushbutton', 'String','1- Open the folder called Data','position',[10,260,200,30],'callback',@LoadData)
 h.edit1=uicontrol(h.Layout,'Style','edit','String',' ','position',[220,260,400,30]);                           
%Create edit for experiment name
 uicontrol(h.Layout,'Style','text','String','2- Experiment name ','position',[20,230,100,30]); 
h.edit2=uicontrol(h.Layout,'Style','edit','String','Exp50L','position',[20,210,100,30]); 
 
 %Create pushbotton to load the table                               
                                
uicontrol(h.Layout,'Style', 'pushbutton', 'String','4- Load the table to select mice ID','position',[10,100,200,40],'callback',@TableFcn)

%% Add panel to corroborate coordinates
h.Coordinates=uipanel('Parent',h.Layout,'Title','3- Arena coordinates','FontSize',9,'ForegroundColor','magenta','Units','pixels','Position',[150,200,650,60]);
uicontrol(h.Coordinates,'Style', 'pushbutton', 'String','Corroborate the arenas coordinates','position',[10,10,200,30],'foreground','red','callback',@CorroborateArenaCoord);
%% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-Add popup menuREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
h.popup1=uicontrol(h.Coordinates,'Style', 'popup', 'String',{'Default','Change'},'position',[210,1,70,25],'foreground','blue');
uicontrol(h.Coordinates,'Style','text','String','Corners ','position',[210,30,50,15]); 

h.popup2=uicontrol(h.Coordinates,'Style', 'popup', 'String',{'Default','Change'},'position',[290,1,70,25],'foreground','blue');
uicontrol(h.Coordinates,'Style','text','String','Eating','position',[290,30,50,15]); 

h.popup3=uicontrol(h.Coordinates,'Style', 'popup', 'String',{'Default','Change'},'position',[370,1,70,25],'foreground','blue');
uicontrol(h.Coordinates,'Style','text','String','Drink loc.','position',[370,30,50,15]); 

uicontrol(h.Coordinates,'Style', 'pushbutton', 'String',' ','position',[600,5,40,30],'foreground','blue','callback',@ReadPopup,'cdata',Image5);

h.popup4=uicontrol(h.Coordinates,'Style', 'popup', 'String',{'Default','Change'},'position',[444,1,70,25],'foreground','blue');
uicontrol(h.Coordinates,'Style','text','String','Bridge L.','position',[444,30,50,15]); 

h.popup5=uicontrol(h.Coordinates,'Style', 'popup', 'String',{'Default','Change'},'position',[515,1,70,25],'foreground','blue');
uicontrol(h.Coordinates,'Style','text','String','Bridge N.','position',[515,30,50,15]); 


%% %% Save the data into excel file with experiment name and save
uicontrol(h.Layout,'Style', 'pushbutton', 'String','5- Save ID to excel','position',[700,10,200,30],'callback',@SaveTableInExcel)

          %% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHCreate pushbutton to open a word document which explains the guiREPLACE_WITH_DASH_DASH-
 uicontrol(h.Layout,'Style', 'pushbutton','String', '','position',[850,230,40,60],'FontSize',9,'ForegroundColor','blue','callback',@OpenWordDocument,'cdata',Image6)   


end
%% auxiliary functions
function OpenWordDocument(~,~)
global root_folder
%This function open the word document with all the information

winopen(strcat(root_folder,'HelpDocuments','\','Module Set mice identity.docx'));

end
%% Read popup menu

function ReadPopup(~,~)
global h
conditions=zeros(1,5);
%% Consider if to use default or to change
list=get(h.popup1,'String');
idx=get(h.popup1,'Value');
option=list(idx);

if strcmp(option,'Change')==1
    conditions(1,1)=1;
end

list=get(h.popup2,'String');
idx=get(h.popup2,'Value');
option=list(idx);
if strcmp(option,'Change')==1
    conditions(1,2)=1;
end


list=get(h.popup3,'String');
idx=get(h.popup3,'Value');
option=list(idx);
if strcmp(option,'Change')==1
    conditions(1,3)=1;
end

list=get(h.popup4,'String');
idx=get(h.popup4,'Value');
option=list(idx);
if strcmp(option,'Change')==1
    conditions(1,4)=1;
end



list=get(h.popup5,'String');
idx=get(h.popup5,'Value');
option=list(idx);
if strcmp(option,'Change')==1
    conditions(1,5)=1;
end
RearrangeArenaCoord(conditions);

end

##### SOURCE END #####
--></body></html>